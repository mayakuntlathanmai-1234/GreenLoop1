<!doctype html>
<html lang="en">
<head>
	<!-- ...existing code... -->
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>Admin Profile</title>
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="../styles.css" />
	<style>
		/* embedded professional overrides */
		:root{
			--bg:#f5f7fb;
			--card:#ffffff;
			--muted:#6b7280;
			--accent:#16a34a;
			--accent-600:#158038;
			--glass: rgba(255,255,255,0.6);
		}
		html,body{height:100%}
		body{
			font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
			margin:0;background:linear-gradient(180deg,#f8fafc 0%,var(--bg) 100%);
			color:#0f172a;
			-webkit-font-smoothing:antialiased;
			-moz-osx-font-smoothing:grayscale;
		}

		.topbar{
			display:flex;align-items:center;justify-content:space-between;padding:14px 20px;
			background:rgba(255,255,255,0.9);backdrop-filter:blur(6px);
			box-shadow:0 6px 18px rgba(12,18,33,0.06);
			position:sticky;top:0;z-index:20;
		}
		.brand{display:flex;align-items:center;gap:12px}
		.brand-logo{width:40px;height:40px;object-fit:contain;border-radius:8px}
		.brand-name{font-weight:700;color:var(--accent-600);font-size:18px;letter-spacing:0.2px}

		.topnav{display:flex;align-items:center;gap:8px}
		.topnav a{
			text-decoration:none;padding:8px 12px;border-radius:8px;color:var(--muted);font-weight:600;
			transition:all .15s ease;
			border:1px solid transparent;
			background:transparent;
		}
		.topnav a:hover{color:#0f172a;background:#fff;border-color:#eef2f6;box-shadow:0 4px 12px rgba(15,23,42,0.04)}

		.container{max-width:980px;margin:30px auto;padding:0 18px}
		.profile-card{
			display:grid;grid-template-columns:220px 1fr;gap:28px;
			background:var(--card);padding:22px;border-radius:12px;
			box-shadow:0 12px 30px rgba(12,18,33,0.06);
			align-items:start;
		}

		.avatar-column{text-align:center}
		.brand-logo.avatar{
			width:140px;height:140px;border-radius:50%;object-fit:cover;border:0px solid #fff;
			box-shadow:0 10px 30px rgba(12,18,33,0.08);
		}
		.avatar-caption{margin-top:12px;color:var(--muted);font-size:13px}

		.details-column h1{margin:0 0 6px 0;font-size:20px}
		.card-sub{color:var(--muted);font-size:13px;margin-bottom:12px}

		form label{display:block;margin-bottom:12px;color:var(--muted);font-size:13px}
		input[type="text"],input[type="email"],select,textarea,input[type="password"]{
			width:100%;padding:12px 14px;border-radius:10px;border:1px solid #e6e9ef;
			background:linear-gradient(180deg,#ffffff,#fbfcfe);
			box-shadow:inset 0 1px 0 rgba(255,255,255,0.5);
			font-size:14px;color:#0f172a;
		}
		textarea{min-height:96px;resize:vertical}
		.actions{display:flex;gap:10px;margin-top:6px}
		button{cursor:pointer;padding:10px 14px;border-radius:10px;border:0;font-weight:600}
		.primary{background:var(--accent);color:#fff;box-shadow:0 8px 20px rgba(22,163,74,0.12)}
		.ghost{background:#fff;border:1px solid #e6e9ef;color:var(--muted)}
		.outline{background:transparent;border:1px dashed #e3e7ee;color:var(--muted)}

		.meta{margin-top:12px;color:var(--muted);font-size:13px}
		.small-note{font-size:13px;color:var(--muted);margin-top:6px}

		.modal-content{max-width:460px}
		.hint{font-size:13px;color:var(--muted);margin-top:10px}

		/* responsive */
		@media (max-width:780px){
			.profile-card{grid-template-columns:1fr;align-items:center;text-align:center}
			.details-column{text-align:left}
			.avatar-column{order:-1}
		}
	</style>
</head>
<body>
	<header class="topbar">
		<div class="brand">
			<a href="index.html" style="display:inline-flex;align-items:center;text-decoration:none;color:inherit;">
				
				<span class="brand-name">GreenLoop Admin</span>
			</a>
		</div>
		<nav class="topnav" aria-label="Primary">
		     <a href="admin_dashboard .html">Dashboard</a>
			<a href="index.html" aria-current="page">Profile</a>
			<a href="admin_events.html">Events</a>
		</nav>
	</header>

	<main class="container">
		<section class="profile-card">
			<div class="avatar-column">
				<img src="icon.png" alt="Administrator avatar" class="brand-logo avatar" />
				<div class="avatar-caption">Administrator</div>
				<div class="small-note">You can update your profile information below.</div>
			</div>

			<div class="details-column">
				<div class="card-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
					<h1>Administrator Profile</h1>
					<div style="font-size:13px;color:var(--muted)"><strong>Role:</strong> Super Admin</div>
				</div>
				<div class="card-sub">Manage your account details and password from this page.</div>

				<form id="profileForm" autocomplete="off">
					<label>
						Name
						<input id="name" name="name" type="text" placeholder="Full name" required />
					</label>

					<label>
						Email
						<input id="email" name="email" type="email" placeholder="admin@example.com" required />
					</label>

					<label>
						Role
						<select id="role" name="role">
							<option>Super Admin</option>
							<option>Admin</option>
							<option>Moderator</option>
						</select>
					</label>

					<label class="bio">
						Bio
						<textarea id="bio" name="bio" rows="4" placeholder="Short bio..."></textarea>
					</label>

					<div class="actions">
						<button id="saveBtn" type="submit" class="primary">Save changes</button>
						<button id="resetBtn" type="button" class="ghost">Reset</button>
						<button id="changePwdBtn" type="button" class="outline">Change password</button>
					</div>

					<div class="small-note" style="margin-top:12px">
						Pro tip: keep your profile up to date so other admins recognize you quickly.
					</div>
				</form>
			</div>
		</section>

		<section class="meta">
			<small>Profile last saved: <span id="lastSaved">never</span></small>
		</section>
	</main>

	<!-- simple password modal -->
	<div id="pwdModal" class="modal hidden" role="dialog" aria-modal="true" aria-hidden="true">
		<div class="modal-content">
			<h2>Change password</h2>
			<form id="pwdForm" autocomplete="off">
				<label>
					New password
					<input id="newPwd" type="password" required minlength="8" />
				</label>
				<label>
					Confirm
					<input id="confirmPwd" type="password" required minlength="8" />
				</label>
				<div class="actions">
					<button type="submit" class="primary" id="pwdSaveBtn">Update</button>
					<button type="button" id="cancelPwd" class="ghost">Cancel</button>
				</div>
				<p class="hint">Note: This demo stores a hashed password client-side.</p>
			</form>
		</div>
	</div>

	<script>
		(function(){
			// Keys
			const PROFILE_KEY = 'greenloop_admin_profile_v1';
			const PASSWORD_KEY = 'greenloop_admin_password_hash_v1';

			// Elements
			const profileForm = document.getElementById('profileForm');
			const nameEl = document.getElementById('name');
			const emailEl = document.getElementById('email');
			const roleEl = document.getElementById('role');
			const bioEl = document.getElementById('bio');
			const lastSavedEl = document.getElementById('lastSaved');
			const changePwdBtn = document.getElementById('changePwdBtn');

			const pwdModal = document.getElementById('pwdModal');
			const pwdForm = document.getElementById('pwdForm');
			const newPwd = document.getElementById('newPwd');
			const confirmPwd = document.getElementById('confirmPwd');
			const cancelPwd = document.getElementById('cancelPwd');
			const pwdSaveBtn = document.getElementById('pwdSaveBtn');

			// small toast helper
			function showToast(message, timeout = 1800){
				const t = document.createElement('div');
				t.textContent = message;
				Object.assign(t.style, {
					position: 'fixed', right: '18px', bottom: '18px',
					background: '#0f5132', color:'#fff', padding:'10px 14px', borderRadius:'10px',
					boxShadow: '0 8px 24px rgba(15,23,42,0.16)', zIndex: 9999, fontFamily:'Inter,system-ui'
				});
				document.body.appendChild(t);
				setTimeout(()=> t.style.opacity = '0.0', timeout - 250);
				setTimeout(()=> document.body.removeChild(t), timeout);
			}

			// crypto helper: sha-256 -> hex
			async function sha256hex(str){
				const enc = new TextEncoder();
				const data = enc.encode(str);
				const hash = await crypto.subtle.digest('SHA-256', data);
				return Array.from(new Uint8Array(hash)).map(b=>b.toString(16).padStart(2,'0')).join('');
			}

			// load profile
			function defaultProfile(){
				return { name:'Admin User', email:'admin@example.com', role:'Super Admin', bio:'', savedAt:'' };
			}
			function loadProfile(){
				try{ const raw = localStorage.getItem(PROFILE_KEY); return raw ? JSON.parse(raw) : defaultProfile(); }
				catch(e){ return defaultProfile(); }
			}
			function saveProfile(p){
				try{ localStorage.setItem(PROFILE_KEY, JSON.stringify(p)); }catch(e){}
			}

			function populateProfile(p){
				nameEl.value = p.name || '';
				emailEl.value = p.email || '';
				roleEl.value = p.role || 'Super Admin';
				bioEl.value = p.bio || '';
				lastSavedEl.textContent = p.savedAt || 'never';
			}

			// init
			const profile = loadProfile();
			populateProfile(profile);

			// profile save handler
			profileForm.addEventListener('submit', function(e){
				e.preventDefault();
				const p = {
					name: nameEl.value.trim(),
					email: emailEl.value.trim(),
					role: roleEl.value,
					bio: bioEl.value.trim(),
					savedAt: new Date().toLocaleString()
				};
				saveProfile(p);
				lastSavedEl.textContent = p.savedAt;
				showToast('Profile saved');
			});

			// open password modal
			function openPwdModal(){
				pwdModal.classList.remove('hidden');
				pwdModal.setAttribute('aria-hidden','false');
				newPwd.value = '';
				confirmPwd.value = '';
				setTimeout(()=> newPwd.focus(), 50);
				document.body.style.overflow = 'hidden';
			}
			function closePwdModal(){
				pwdModal.classList.add('hidden');
				pwdModal.setAttribute('aria-hidden','true');
				document.body.style.overflow = '';
			}

			changePwdBtn && changePwdBtn.addEventListener('click', function(){
				openPwdModal();
			});

			cancelPwd && cancelPwd.addEventListener('click', function(){
				closePwdModal();
			});

			// close modal on backdrop click
			pwdModal.addEventListener('click', function(e){
				if (e.target === pwdModal) closePwdModal();
			});

			// keyboard ESC closes modal
			document.addEventListener('keydown', function(e){
				if (e.key === 'Escape' && !pwdModal.classList.contains('hidden')) closePwdModal();
			});

			// password submit: validate, hash, store, feedback
			pwdForm.addEventListener('submit', async function(e){
				e.preventDefault();
				const a = newPwd.value || '';
				const b = confirmPwd.value || '';

				if (a.length < 8){
					alert('Password must be at least 8 characters.');
					newPwd.focus();
					return;
				}
				if (a !== b){
					alert('Passwords do not match.');
					confirmPwd.focus();
					return;
				}

				// disable to prevent repeated clicks
				pwdSaveBtn.disabled = true;
				pwdSaveBtn.textContent = 'Saving…';
				try{
					const hash = await sha256hex(a);
					try{ localStorage.setItem(PASSWORD_KEY, hash); }catch(e){}
					// show confirmation dialog
					closePwdModal();
					// small confirmation overlay
					const overlay = document.createElement('div');
					Object.assign(overlay.style, { position:'fixed', inset:0, background:'rgba(2,6,23,0.45)', display:'flex', alignItems:'center', justifyContent:'center', zIndex:9999 });
					const card = document.createElement('div');
					Object.assign(card.style, { background:'#fff', padding:'20px 22px', borderRadius:'12px', textAlign:'center', minWidth:'260px', boxShadow:'0 12px 40px rgba(2,6,23,0.18)' });
					card.innerHTML = '<div style="font-size:28px;color:#16a34a;margin-bottom:8px">✔</div><div style="font-weight:700;margin-bottom:8px">Password changed</div><div style="color:#6b7280;margin-bottom:12px">Your admin password was updated.</div>';
					const ok = document.createElement('button');
					ok.textContent = 'OK';
					Object.assign(ok.style, { padding:'8px 14px', borderRadius:'8px', border:'0', background:'#16a34a', color:'#fff', cursor:'pointer' });
					ok.addEventListener('click', ()=> document.body.removeChild(overlay));
					card.appendChild(ok);
					overlay.appendChild(card);
					document.body.appendChild(overlay);
				} catch(err){
					alert('Unable to save password (storage error).');
				} finally{
					pwdSaveBtn.disabled = false;
					pwdSaveBtn.textContent = 'Update';
				}
			});
		})();
	</script>
</body>
</html>
